function cercle(e,r=0,i=0){var o=document.getElementById(e),t=o.getContext("2d"),n=o.width/2,a=o.height/2;t.beginPath(),0!=r&&(t.strokeStyle=r),0!=i&&(t.fillStyle=i),t.lineWidth="8",t.arc(n,a,45,0,2*Math.PI,!1),0!=r&&t.stroke(),0!=i&&t.fill()}function triangle(e,r,i){var o=document.getElementById(e).getContext("2d");o.beginPath(),o.strokeStyle=r,o.lineWidth="7",o.moveTo(50,7),o.lineTo(5,95),o.lineTo(95,95),o.lineTo(50,7),o.closePath(),o.stroke(),o.fillStyle=i,o.fill()}function carre(e,r,i,o,t=0,n=0){var a=document.getElementById(e).getContext("2d");a.beginPath(),0!=t&&(a.strokeStyle=t),a.lineWidth="8",a.rect(r,i,o,o),0!=n&&(a.fillStyle=n),0!=t&&a.stroke(),0!=n&&a.fill()}function etoile(e,r,o,t,n,a,l=0,s=0){var c=document.getElementById(e).getContext("2d"),$=Math.PI/2*3,u=r,d=o,b=Math.PI/t;for(0!=l&&(c.strokeStyle=l),c.beginPath(),c.moveTo(r,o-n),i=0;i<t;i++)u=r+Math.cos($)*n,d=o+Math.sin($)*n,c.lineTo(u,d),$+=b,u=r+Math.cos($)*a,d=o+Math.sin($)*a,c.lineTo(u,d),$+=b;c.lineTo(r,o-n),c.closePath(),c.lineWidth=7,0!=l&&(c.strokeStyle=l),c.stroke(),0!=s&&(c.fillStyle=s),c.fill()}function shuffle(e){for(var r=0,i="",o=i,t=e.length-1;t>-1;)r=Math.floor(Math.random()*t),i=e[t],o=e[r],e[t]=o,e[r]=i,t-=1;return e}let couleurs=["red","blue","yellow","green","purple","maroon","hotpink","darkorange"],couleursOrder=[].concat(couleurs),nbFormes=0,couleursNiv=couleurs.slice(0,nbFormes);function toggleSound(){var e=document.getElementById("music");e.loop=!0,e.paused?e.play():e.pause()}function GoInFullscreen(e){e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}$(document).ready(function(){for($i=1;$i<=10;$i++)$2et=$("#2et_level_"+$i).html(),$3et=$("#3et_level_"+$i).html(),console.log("level "+$i+" : "+$2et+" "+$3et);function e(e){for($j=0,$valI="",$valJ=$valI,$l=e.length-1;$l>-1;)$j=Math.floor(Math.random()*$l),$valI=e[$l],$valJ=e[$j],e[$l]=$valJ,e[$j]=$valI,$l-=1;return e}$icon=$("#playerMusic"),$music=$("#music"),$music.prop("volume",.7),$icon.mouseenter(function(){$music.prop("controls",!0)}),$("#audioTool").mouseleave(function(){$music.prop("controls",!1)}),$icon.click(function(){"img/audio/music-off.png"==$icon.attr("src")?($icon.removeAttr("src"),$icon.attr("src","img/audio/music-on.png")):($icon.removeAttr("src"),$icon.attr("src","img/audio/music-off.png"))}),$couleurs=["red","blue","yellow","green","black","purple","maroon","hotpink","darkorange"],$couleursOrder=[].concat($couleurs),ion.sound({sounds:[{name:"success",volume:.1},{name:"success_level",volume:.1},{name:"success_game",volume:.2}],volume:.2,path:"sounds/",preload:!0}),$bruit=$("#toggleBruit"),$bruit.click(function(){"img/audio/bruit-off.png"==$bruit.attr("src")?($bruit.removeAttr("src"),$bruit.attr("src","img/audio/bruit-on.png")):($bruit.removeAttr("src"),$bruit.attr("src","img/audio/bruit-off.png"))}),$nbEtoiles="",$nbClick=0,$nbCarres=3,$nbFormes=0,$nbCouleurs=0,$dureeTotale=0,$scoreEtoiles=0;let r=$nbClick,i=new Date(Date.now()+864e5);function o(){$("#containerOrigin").hide(),$nbClick>8&&$nbClick<=10&&($("#panier_1").remove(),$("#panier_2").remove()),$fin=new Date,$finMs=$fin.getTime(),$duree=($finMs-$debutMs)/1e3,$dureePartieParLevel.push($duree),10==$nbClick&&($finPartieMs=$finMs),$nbClick<=9&&($("#containerCible").css("background-image","none"),$nbClick<9?$("#containerCible").css("bottom","80%"):$("#containerCible").css("bottom","80%").css("right","80%"),$("#cible").css("bottom","72%"),$(".reussiteCorrespondance_"+$rand).hide(),$("#nextLevel").fadeIn(500),"img/audio/bruit-on.png"==$bruit.attr("src")&&ion.sound.play("success_level")),$("#successLevel").removeAttr("src"),$duree<parseInt($("#3et_level_"+$nbClick).html())?($nbEtoiles=3,$("#successLevel").attr("src","img/game/3etoiles-500.png")):$duree>parseInt($("#2et_level_"+$nbClick).html())?($nbEtoiles=1,$("#successLevel").attr("src","img/game/1etoile-500.png")):($nbEtoiles=2,$("#successLevel").attr("src","img/game/2etoiles-500.png")),$scorePartieParLevel.push($nbEtoiles),$scoreEtoiles+=$nbEtoiles,$("#scoreAffiche").text($scoreEtoiles),$scoreTotalAfficher=parseInt($scoreTotal)+parseInt($scoreEtoiles),$("#scoreCumul").text($scoreTotalAfficher),console.log("####################################################################################################"),console.log("level "+$nbClick),console.log("Temps réalisé (en s) : "+$duree),console.log("Nombre d'étoiles gagnées dans ce niveau: "+$nbEtoiles),console.log("Nombre d'étoiles cumulées au cours de la partie : "+$scoreEtoiles),console.log("Tab qui renvoie le score par niveau : "+$scorePartieParLevel),console.log("Tab qui renvoie le temps réalisé par level : "+$dureePartieParLevel),console.log("####################################################################################################");let e=$nbEtoiles;document.cookie="score"+r+"="+e+"; path=/; expires="+i;let o=$duree;if(document.cookie="temps"+r+"="+o+"; path=/; expires="+i,10==$nbClick){if($("#successLevel").delay(2500).hide(),$("#containerCible").css("bottom","70%"),$dureePartie=0,$dureePartieMinutes=0,$dureePartieSecondes=0,"img/audio/music-on.png"==$icon.attr("src")&&"img/audio/bruit-on.png"==$bruit.attr("src"))document.getElementById("music").pause(),ion.sound.play("success_game");const e=["#3CC157","#2AA7FF","#1B1B1B","#FCBC0F","#F85F36"],r=100,o=[];for(let i=0;i<r;i++){let r=document.createElement("div");r.classList.add("ball"),r.style.background=e[Math.floor(Math.random()*e.length)],r.style.left=`${Math.floor(100*Math.random())}vw`,r.style.top=`${Math.floor(100*Math.random())}vh`,r.style.transform=`scale(${Math.random()})`,r.style.width=`${Math.random()}em`,r.style.height=r.style.width,o.push(r),document.body.append(r)}for(o.forEach((e,r,i)=>{let o=Math.random()*(r%2==0?-11:11),t=12*Math.random();e.animate([{transform:"translate(0, 0)"},{transform:`translate(${o}rem, ${t}rem)`}],{duration:2e3*(Math.random()+1),direction:"alternate",fill:"both",iterations:1/0,easing:"ease-in-out"})}),$i=0;$i<$dureePartieParLevel.length;$i++)$dureePartie+=$dureePartieParLevel[$i];$dureePartie=Math.round($dureePartie),$dureePartieMinutes=Math.floor($dureePartie/60),$dureePartieSecondes=$dureePartie%60,console.log("####################################################################################################"),console.log("Temps total en secondes : "+$dureePartie),console.log("Temps total en min:s : "+$dureePartieMinutes+" : "+$dureePartieSecondes),console.log("Nombre d'étoiles cumulées au cours de la partie : "+$scoreEtoiles),console.log("Tab qui renvoie le temps réalisé par level : "+$dureePartieParLevel),console.log("####################################################################################################"),$("#gameFinished").show(100),$("#gameEnd").show(300),$("#gameFinished").append('<span id="msgGameFinished" class="msgVictoire">Bravo, tu as gagné '+$scoreEtoiles+' etoiles au cours de cette partie !"</span><br>'),$("#gameFinished").append('<span id="msgGameFinished" class="msgVictoire">Tu as terminé Color-Drop en '+$dureePartieMinutes+" minutes et "+$dureePartieSecondes+' secondes.")</span>');let t=$scoreEtoiles;document.cookie="scoreTotal="+t+"; path=/; expires="+i}}i=i.toUTCString(),$difficulte="",$choixJoueur=$("#choixDiff").text(),$snapTolerance=0,console.log($choixJoueur),"facile"==$choixJoueur&&($difficulte="pointer",$snapTolerance=20),"moyen"==$choixJoueur&&($difficulte="intersect",$snapTolerance=10),"difficile"==$choixJoueur&&($difficulte="fit",$snapTolerance=5),$scoreTotal=$("#scoreCumulInit").text(),$scoreTotalAfficher=parseInt($scoreTotal),$("#scoreCumul").text($scoreTotalAfficher),$dureePartieParLevel=[],$scorePartieParLevel=[],$(".ecouteurJeu").click(function(){if($debut=new Date,$debutMs=$debut.getTime(),$debutPartieMs=$debutMs,$nbClick++,console.log("Début (en ms) du level "+$nbClick+" : "+$debutMs),console.log("le nombre de clicks est de "+$nbClick),1===$nbClick?(r=1,$("div").remove(".radialtimer"),window.innerWidth<890?(GoInFullscreen($("#element").get(0)),$("#fullScreen").attr("src","img/reduce-128-blue.png"),$(".fullScreen").css("display","initial")):($("#fullScreen").attr("src","img/expand-128-blue.png"),$(".fullScreen").css("display","initial")),$("#lancerJeu").fadeOut(500,function(){$("#containerOrigin").fadeIn(600)}),$("#containerCible").css("background-image","url('../img/tab-f2.png')"),$("#score").fadeIn(600),$("#player").fadeIn(600),$nbCarres=3,$nbCouleurs=3):2===$nbClick?($("#containerOrigin").fadeIn(600),$("#containerCible").css("background-image","url('../img/tab-f2.png')"),$("#containerCible").css("bottom","10%"),$("#cible").css("bottom","52%"),r=2,$nbCarres=5,$nbCouleurs=5):3===$nbClick?($("#containerOrigin").fadeIn(600),$("#containerCible").css("background-image","url('../img/tab-f2.png')"),$("#containerCible").css("bottom","10%"),$("#cible").css("bottom","52%"),r=3,$nbCarres=7,$nbCouleurs=7):4===$nbClick&&($("#containerOrigin").fadeIn(600),$("#containerCible").css("background-image","url('../img/tab-f2.png')"),$("#containerCible").css("bottom","10%"),$("#cible").css("bottom","52%"),r=4,$nbCarres=9,$nbCouleurs=9),$nbClick<5){for($("#successLevel").removeAttr("src"),$("#levelNumber").text("Niveau "+$nbClick),$("#nextLevel").fadeOut(500),$position=$couleurs.length-1;$position>=1;$position--)$hasard=Math.floor(Math.random()*($position+1)),$sauve=$couleurs[$position],$couleurs[$position]=$couleurs[$hasard],$couleurs[$hasard]=$sauve;for($d=0,"fit"==$difficulte?window.innerWidth<1e3?$d="20%":$d="18%":$d="15%",$i=0;$i<$nbCarres;$i++)$("#cible").append('<canvas id="carre_'+$i+'" width="100" height="100" style ="width :'+$d+' ; height : auto ;" class="draggable mx-2 mb-2"></canvas>');for($("#origin").empty(),$i=0;$i<$couleurs.length;$i++)$("#origin").append('<canvas id="carre_'+$couleurs[$i]+'" width="80" height="80"  style ="width :8% ; height : auto ; z-index: 999;" class="bg-darky mx-2"></canvas>');for($i=0;$i<$couleurs.length;$i++)carre("carre_"+$couleurs[$i],0,0,80,0,$couleurs[$i]);for($couleursNiv=$couleursOrder.slice(0,$nbCouleurs),$couleurCibles=e($couleursNiv),$i=0;$i<$nbCouleurs;$i++)carre("carre_"+$i,10,10,80,"black",$couleurCibles[$i]);for(console.log("$couleurCibles : random des n premieres couleurs de la palette (par level) : "+$couleurCibles),console.log("$couleurs : doit censé renvoyé un random de la color palette : "+$couleurs),console.log(window.innerWidth),$i=0;$i<9;$i++)$("#carre_"+$couleurs[$i]).draggable({containment:"body",snap:".draggable",snapTolerance:$snapTolerance,revert:"invalid",cursor:"pointer"});for($nb=0,$i=0;$i<$nbCarres;$i++)$("#carre_"+$i).droppable({accept:"#carre_"+$couleurCibles[$i],tolerance:$difficulte,drop:function(e,r){"img/audio/bruit-on.png"==$bruit.attr("src")&&ion.sound.play("success"),$(r.draggable).remove(),$rand=Math.floor(Math.random()*Math.floor(13))+1,console.log($rand),$(".reussiteCorrespondance_"+$rand).show().fadeIn(500).delay(1200).fadeOut(200,function(){$(this).hide()}),$(this).effect("pulsate").addClass("correct").delay(1e3).fadeOut(300,function(){$(this).remove(),$nb++,$nb==$nbCarres&&o()})}})}if($d=0,$nbClick>4&&$nbClick<9){for($i=$nbClick,r=$i,couleurTab=[],$("#levelNumber").text("Niveau "+$i),$("#successLevel").removeAttr("src"),$("#nextLevel").fadeOut(500),$nbFormes=-2+$i,nbFormes=-2+$i,couleurTab[$i-5]=[],$("#containerOrigin").fadeIn(600),$("#containerCible").css("background-image","url('../img/tab-f2.png')"),$("#containerCible").css("bottom","10%"),$("#cible").css("bottom","52%"),$("#cible").empty(),$("#origin").empty(),couleurTab[$i-5]=e(couleursOrder),couleurTab[$i-5]=[].concat(couleurTab[$i-5]),console.log(couleurTab),function(){for($suites=[],$x1=[],$x2=[],$y=0;$y<$nbFormes;$y++)$suites[$y]=$y}(),$x1=e($suites),$x1=[].concat($x1),function(){for($formesCibles=[],"fit"==$difficulte?window.innerWidth<1e3?$d="19%":$d="17%":$d="15%",$z=0;$z<$nbFormes;$z++)$formesCibles[$z]='<canvas id="formeCible'+$z+'" width="100" height="100" style ="width :'+$d+' ; height : auto ;" class="draggable mx-3 mb-2"></canvas><br>'}(),$j=0;$j<$formesCibles.length;$j++)$("#cible").append($formesCibles[$x1[$j]]);for($x2=e($x1),$x2=[].concat($x2),function(){for($formes=[],$z=0;$z<$nbFormes;$z++)$formes[$z]='<canvas id="forme'+$z+'" width="100" height="100" style ="width :8% ; height : auto; z-index: 999" class="bg-darky2 mx-3"></canvas><br>'}(),$j=0;$j<$formes.length;$j++)$("#origin").append($formes[$x2[$j]]);for($i>=5&&(cercle("formeCible0","black",couleurTab[$i-5][0]),triangle("formeCible1","black",couleurTab[$i-5][3]),carre("formeCible2",10,10,80,"black",couleurTab[$i-5][2]),cercle("forme0","black",couleurTab[$i-5][0]),triangle("forme1","black",couleurTab[$i-5][3]),carre("forme2",10,10,80,"black",couleurTab[$i-5][2]),$i>=6&&(etoile("formeCible3",50,52,5,45,25,"black",couleurTab[$i-5][1]),etoile("forme3",50,52,5,45,25,"black",couleurTab[$i-5][1]),$i>=7&&(carre("formeCible4",10,10,80,"black",couleurTab[$i-5][4]),carre("forme4",10,10,80,"black",couleurTab[$i-5][4]),8==$i&&($random=Math.floor(Math.random()*Math.floor(3)),0==$random&&(triangle("formeCible5","black",couleurTab[$i-5][5]),triangle("forme5","black",couleurTab[$i-5][5])),1==$random&&(cercle("formeCible5","black",couleurTab[$i-5][5]),cercle("forme5","black",couleurTab[$i-5][5])),2==$random&&(etoile("formeCible5",50,52,5,45,25,"black",couleurTab[$i-5][5]),etoile("forme5",50,52,5,45,25,"black",couleurTab[$i-5][5])))))),$j=0;$j<$nbFormes;$j++)$("#forme"+$j).draggable({containment:"body",snap:".draggable",snapTolerance:$snapTolerance,revert:"invalid",cursor:"pointer"});for($nb=0,$j=0;$j<$nbFormes;$j++)$("#formeCible"+$j).droppable({accept:"#forme"+$j,tolerance:$difficulte,drop:function(e,r){"img/audio/bruit-on.png"==$bruit.attr("src")&&ion.sound.play("success"),$(r.draggable).remove(),$rand=Math.floor(Math.random()*Math.floor(13))+1,console.log($rand),$(".reussiteCorrespondance_"+$rand).show().fadeIn(500).delay(1200).fadeOut(200,function(){$(this).hide()}),$(this).effect("pulsate").addClass("correct").delay(500).fadeOut(300,function(){$(this).remove(),$nb++,$nb==$nbFormes&&o()})}})}if($nbFruits=6,$ordre=[0,1,2,3,4,5],$desordre=e($ordre),$desordreFix=[].concat($desordre),$coul_ok=[["orange_ok","vert_ok"],["jaune_ok","rouge_ok"]],$nbClick>8&&$nbClick<11){for($("#levelNumber").text("Niveau "+$nbClick),$("#containerOrigin").css("background-image","url('../img/wood2.png')"),$("#containerOrigin").fadeIn(600),$("#nextLevel").fadeOut(500),$("#successLevel").removeAttr("src"),9===$nbClick&&(r=9,$(".rowFlex").css("flex-wrap","nowrap"),$("#containerCible").css("bottom","10%").css("width","90%").css("right","5%"),$(".cible").css("position","static").css("width","100%").css("margin-top","3vw"),$("body").css("background-image","url('../img/fond-sans-soleil.png')"),$("#cible").removeClass("align-items-center justify-content-center")),10===$nbClick&&(r=10,$("#containerCible").css("bottom","10%").css("width","90%").css("right","5%"),$("#cible").css("bottom","52%"),$("#panier_1").empty(),$("#panier_2").empty()),$("#cible").append('<div id="panier_1" class="draggable panier-gauche d-inline-block"><img src="../img/game/'+$coul_ok[$nbClick-9][0]+'.png" width="200" class="panier panier-flex img-fluid" alt="Panier de fruits"></div>'),$("#cible").append('<div id="panier_2" class="draggable panier-droite d-inline-block"><img src="../img/game/'+$coul_ok[$nbClick-9][1]+'.png" width="200" class="panier panier-flex img-fluid" alt="Panier de fruits"></div>'),$(".correct").css("display","none"),$("#origin").empty(),$panier1Drop=[],$panier2Drop=[],$("#origin").removeClass("origin").addClass("originFruits"),9===$nbClick&&($fruitsImg=["vert-avocat","vert-citron","vert-kiwi","orange-ananas","orange-carotte","orange-orange"]),10===$nbClick&&($fruitsImg=["jaune-ananas","jaune-banane","jaune-citron","rouge-pomme","rouge-cerises","rouge-fraise"]),$i=0;$i<$nbFruits;$i++)$("#origin").append('<img id="fruitCible_'+$i+'" src="../img/game/fruits/'+$fruitsImg[$desordreFix[$i]]+'.png" class="maxHeigth mx-3" width="50" alt="Fruit"></div>'),$x=$("#fruitCible_"+$i).attr("src").slice(19,22),$id="fruitCible_"+$i,"ora"===$x?$panier1Drop.push($id):$panier2Drop.push($id);for($i=0;$i<$nbFruits;$i++)"ora"==$("#fruitCible_"+$i).attr("src").slice(19,22)||"jau"==$("#fruitCible_"+$i).attr("src").slice(19,22)?$("#fruitCible_"+$i).addClass("drop1"):$("#fruitCible_"+$i).addClass("drop2")}for($nb=0,$i=0;$i<$nbFruits;$i++)$("#fruitCible_"+$i).draggable({containment:"body",snap:".draggable",snapTolerance:$snapTolerance,revert:"invalid"});for($i=1;$i<3;$i++)$("#panier_"+$i).droppable({accept:".drop"+$i,tolerance:$difficulte,drop:function(e,r){"img/audio/bruit-on.png"==$bruit.attr("src")&&ion.sound.play("success"),$(r.draggable).remove(),$rand=Math.floor(Math.random()*Math.floor(13))+1,console.log($rand),$(".reussiteCorrespondance_"+$rand).show().fadeIn(500).delay(1200).fadeOut(200,function(){$(this).hide()}),$(this).addClass("correct").effect("pulsate").delay(500).fadeOut(300,function(){$(this).removeClass("correct").delay(1500).fadeOut(),$nb++,$nb==$nbFruits&&o(),$("#panier_"+$i).removeClass("correct")})}})})});